<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Chat Hub</title>
    <style type="text/css">
        .container {
            background-color: #99CCFF;
            border: thick solid #808080;
            padding: 20px;
            margin: 20px;
        }
    </style>
</head>
<body>
<div class="container">
    <input type="text" id="message" />
    <input type="button" id="send" value="Send" />
    <ul id="messages"></ul>
</div>
<script src="Scripts/jquery-3.1.1.min.js"></script>
<script src="Scripts/jquery.signalR-2.2.1.min.js"></script>
<script src="http://localhost:12345/signalr/hubs"></script>
<script type="text/javascript">
    function writeMsg(msg) {
        $('#messages').append('<li>' + msg + '</li>');
    }


    $(function() {
        var chat = $.connection.chatHub;

        chat.client.UserStateChanged = function(msg) {
            var c = msg.Connected ? " Connected" : " Disconnected";
            writeMsg(msg.Name + c);
        };

        chat.client.MessageReceived = function(msg) {
            var from = $('<div />').text(msg.From).html();
            var body = $('<div />').text(msg.Body).html();
            writeMsg('<strong>[' + from + ']</strong>: ' + body);
        };

        writeMsg('Connecting to server');

        $.connection.hub.start().done(function () {
            writeMsg('Connected');
            $('#send').click(function () {

                var el = $('#message');
                chat.server.sendMessage(el.val());
                el.val('').focus();
                writeMsg('Message sent');
            });
        });
    });
</script>
</body>
</html>